
<!-- FOR DEBUG -->
<!--<html><body>
<script type="text/javascript" src="/public/javascripts/jquery-1.9.1.min.js"></script>
<link href="/public/bootstrap/css/bootstrap.css" rel="stylesheet" type="text/css">
<link href="/public/bootstrap/css/bootstrap-responsive.css" rel="stylesheet">
<script type="text/javascript" src="/public/bootstrap/js/bootstrap.js"></script>
<script type="text/javascript" src="/public/includes/highcharts/highstock.js"></script>-->
<!-- ********* -->


<div class="row-fluid">
	<div class="span12">
		<legend>
			Add Embedded Chart
		</legend>
		<p>
			An embedded chart is a chart that was created with the <a href="@{gui.MyCharts.createChart()}">Create Chart Wizard</a>.  The result
			is a URL which contains all of the information for displaying the chart.
		</p>
		#{form @postSaveEmbeddedChartSettings(), id:'saveembeddedchartsettings'}
		<div class="row-fluid">
			<div class="span12" style="margin-top: 20px; margin-left: 40px;">
				<table class="table-condensed">
					<tbody>
						<tr>
							<td class="db_settings_label_td table-bordered">
								Chart Name:
							</td>
							<td class="db_settings_input_td table-bordered">
								<input id="embedded_chart_name" name="embedded_chart_name" class="input-large" type="text" placeholder="Enter a chart name..." style="margin-bottom: 0px; height: 25px; font-size: 16px;">
							</td>
							<td></td>
						</tr>
						<tr>
							<td class="db_settings_label_td table-bordered">
								URL:
							</td>
							<td class="db_settings_input_td table-bordered">
								<div class="input-append" style="margin-bottom: 0px;">
									<input id="embedded_chart_url" name="embedded_chart_url" class="input-xxlarge" type="text" placeholder="Chart URL..." style="margin-bottom: 0px; height: 25px; font-size: 16px;">
									<a id="test_embedded_chart" class="btn" style="height: 20px; font-size: 12px; padding-left: 8px; padding-top: 7px; padding-bottom: 6px;">Test</a>
								</div>
							</td>
							<td></td>
						</tr>
						<tr>
							<td colspan="3" align="center">
								<div class="span12" style="margin: auto;">
									<div id="embedded_chart_preview_base" class="db_summary_chart table-bordered" style="height: 250px; margin-left: 10px; margin-right: 5px;"></div>
									<div id="embedded_chart_preview" style="height: 250px; margin-left: 10px; margin-right: 5px; display: none;"></div>
								</div>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div class="row-fluid">
			<div class="span1"></div>
			<div class="span2 controls" style="margin-top: 12px;">
				<input id="embedded_submit" type="submit" name="submit" value="Save" class="btn btn-primary" />
				<a id="clear_embedded_chart_form" class="btn">Clear</a>
			</div>
			<div id="embedded_warning" class="span6 alert alert-error"></div>
			<div class="span3"></div>
		</div>
		#{/form}
	</div>
</div>
<div class="row-fluid" style="margin-top: 30px;">
	<div class="span12">
		<legend>
			Add Script Chart
		</legend>
	</div>
</div>

<script type="text/javascript">
	$(document).ready(function() {
		/**
		 * Clear everything first...
		 */
		clearEmbeddedForm();
		
		/**
		 * Remove form enter key submit
		 */
		$('saveaddchartsettings input').keydown(function(event){
			if(event.keyCode == 13) {
				event.preventDefault();
				return false;
			}
		});
  
		/**
		 * Now show our fake chart
		 */
		showBlankChart('embedded_chart_preview_base');
	});
	
	$('#embedded_submit').on('click', function (e) {
		if($('#embedded_chart_name').val() === "") {
			$('#embedded_warning').show();
			$('#embedded_warning').html("The chart must have a name before it can be saved.");
			e.preventDefault();
			return;	
		}
		if($('#embedded_chart_url').val() === "") {
			$('#embedded_warning').show();
			$('#embedded_warning').html("The chart must have a url before it can be saved.");
			e.preventDefault();
			return;	
		}
	});
	
	$('#test_embedded_chart').on('click', function (e) {
		$('#embedded_warning').html("");
		$('#embedded_warning').hide();
		
		if($('#embedded_chart_url').val() != "") {
			$('#embedded_chart_preview').show();
			$('#embedded_chart_preview_base').hide();
			var chartURL = $('#embedded_chart_url').val() + "?divname=embedded_chart_preview&height=250";
			chartURL = chartURL.replace("/charts/chart/", "/charts/jschart/"); 
			
			$.get(chartURL, function(data) {
				var chartData = new Function (data);
				chartData();
			});
		}
    	});
	
	$('#clear_embedded_chart_form').on('click', function (e) {
		clearEmbeddedForm();
    	});
    	
    	function clearEmbeddedForm() {
    		$('#embedded_chart_name').val("");
		$('#embedded_chart_url').val("");
		$('#embedded_warning').html("");
		$('#embedded_warning').hide();
		$('#embedded_chart_preview').hide();
		$('#embedded_chart_preview').html("");
		$('#embedded_chart_preview_base').show();
    	}

	function showBlankChart(divArea) {
		$(function () {
			var chartTitle = "Preview";
			
			var blankChart_alphabetLabel = ['', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z'];
	
			var blankChart_xAxisLabels = {
			    categories: ['','Add', 'a', 'chart', 'to', 'your', 'dashboard', ''],
			    labels:{
			                step: 1
			            },
			    text: null
			};
			
			var blankChartSeriesData = [{
			                    showInLegend: false,
			                    data: [0,1,1,3,20,25,4,0]
			                    }];
			
			var blankChart = new Highcharts.Chart({
			    title: {
			        text: chartTitle
			    },
			    chart: {
			        renderTo: divArea
			    },
			
			    xAxis: blankChart_xAxisLabels,
			    yAxis: {
			            endOnTick: false,
			            min: 0,
			            max: 26,
			            tickInterval: 2,
			            title: { text: 'Alphabet' },
			            labels: {
			                        formatter: function() {
			                            return blankChart_alphabetLabel[this.value];
			                        }
			                    }  
			            },
			
			    series: blankChartSeriesData
			
			});
		});
	}
</script>

<!-- FOR DEBUG -->
<!--</body></html>-->
<!-- ********* -->