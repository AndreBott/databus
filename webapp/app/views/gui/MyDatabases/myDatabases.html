#{extends '/main_body_container.html' /}
#{set title:'My Databases' /}
#{set tab:'home' /}

%{
   if(gov.nrel.util.Utility.isDemoMode()) {
}%
<div class="alert alert-info alert-block">
   Step 5. You are now viewing the databases you have access to(and each database has many tables)</br>
   We have created and given you access to a DemoDatabase.  You can create your own databases and give users access to those</br>
   Step 6. Next, please click on the DemoDatabase link
</div>
%{
    }
}%

<h1 class="db_page_title">My Databases</h1>

<p>These are the databases you have access to.  Each database may contain multiple tables</p>

#{list databases, as:'database'}
	<!--=======================================-->
	<!--The following is the DELETE MODAL BLOCK-->
	<!--=======================================-->
	<input type="hidden" name="del_databaseId" value="${database.id}"/>
	<input type="hidden" name="del_database" value="${database.getSchemaName()}"/>
	
	<div id="myDeleteModal${database_index}" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myDeleteModalLabel" aria-hidden="true">
	  <div class="modal-header">
	    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
	    <h3 id="myModalLabel">Delete confirmation</h3>
	  </div>
	  <div class="modal-body">
	  	<p>
	        The action of deleting an entire Database, including all of its' tables and data, is
	        a very invasive change to the system.  As of right now we do not support removing
	        entire databases. 
	    </p>
	  </div>
	  <div class="modal-footer">
	    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
	  </div>
	</div>
	<!--=======================================-->
	<!--End of DELETE MODAL BLOCK-->
	<!--=======================================-->
	
	<!--=======================================-->
	<!-- The following is the EDIT MODAL BLOCK -->
	<!--=======================================-->
	#{form @editDatabase(), id:'editdatabase'+database_index, class:'form-horizontal', style:'min-width:500px;max-width:800px;margin: 0 auto'}
		<div id="myEditModal${database_index}" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myEditModalLabel" aria-hidden="true">
		  <div class="modal-header">
		    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
		    <h3 id="myEditModalLabel">Database Properties</h3>
		  </div>
		  <div class="modal-body">  
		  	#{formfield 'database'}
			<div class="control-group ${field.errorClass}">
				<label class="control-label"><a href="#" rel="tooltip" title="Some help message for schema name"><i class="icon-info-sign"></i></a> Name</label>
				<div class="controls">			
					<input type="text" name="edit_dbName" value="${database.getSchemaName()}" maxlength="50" class="input-xlarge" readonly="readonly">			 
					<span class="help-block">${field.error}</span>
				</div>
			</div>
		    #{/formfield}
			
			#{formfield 'description'}
			<div class="control-group">
				<label class="control-label"><a href="#" rel="tooltip" title="Some help message"><i class="icon-info-sign"></i></a> Description</label>
				<div class="controls">
				   	<textarea name="edit_dbDescription" rows="12" cols="100" class="input-xlarge">${database.getDescription()}</textarea>
					<span class="help-block">${field.error}</span>
				</div>
			</div>
		    #{/formfield}
		  </div>
		  <div class="modal-footer">
		    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
		    <input type="submit" name="submit" value="Save" class="btn btn-primary" />
		  </div>
		</div>
	#{/form}
#{/list}
<!--=======================================-->
<!-- End of EDIT MODAL BLOCK -->
<!--=======================================-->

<div class="span8">
	<table class="table">
		<thead>
		    <tr>
		        <th>Name</th>
		    </tr>
		</thead>
		<tbody>
		    #{list databases, as:'database'}
		        <tr>
		            <td><a href="@{viewDatabase(database.schemaName)}">${database.getSchemaName()}</a></td>
		            <td style="text-align: right;">
		                <a href="#myEditModal${database_index}" data-toggle="modal">
		                	edit
		                </a>
		                &nbsp;&nbsp;|&nbsp;
		                <a href="#myDeleteModal${database_index}" data-toggle="modal">
	                        delete
		                </a>
		            </td>
		        </tr>
		    #{/list}
		    #{else}
		    <tr>
				<td colspan=2>You do not own to any Databases yet.  <a href="@{dbProperties(null)}">Add a Database Now!!!</a></td>
			</tr>
		    #{/else}
		</tbody>
	</table>
</div>
<div class="span4"></div>

  
<p style="clear: both;">
  	<a href="@{dbProperties(null)}" class="btn btn-primary">Add Database</a>
</p>
  
